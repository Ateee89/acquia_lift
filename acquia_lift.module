<?php

use Drupal\acquia_lift\Entity\Credential;

/**
 * Implements hook_page_attachments() to insert JavaScript to the appropriate scope/region of the page.
 */
function acquia_lift_page_attachments(array &$page) {
  $page_attachments_manager = \Drupal::service('acquia_lift.service.page_attachments_manager');

  if (!$page_attachments_manager->shouldAttach()) {
    return;
  }

  $settings = array(
    'test' => 123,
  );

  if (!empty($settings)) {
    $page['#attached']['drupalSettings']['acquia_lift'] = $settings;
  }

  $page['#attached']['html_head'][] = [
    // The data.
    [
      // The HTML tag to add, in this case a <script> tag.
      '#tag' => 'script',
      // The value of the HTML tag, here we want to end up with <script>console.log("loaded!");</script>.
      '#value' => 'console.log("loaded!");',
    ],
    // A key, to make it possible to recognize this HTML <HEAD> element when altering.
    'acquia_lift_loaded'
  ];
}
